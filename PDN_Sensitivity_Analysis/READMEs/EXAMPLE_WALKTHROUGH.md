# 敏感度分析實例演練

## 場景設定

假設我們有一個簡單的 3×3 PDN 網格：

```
(0,0) ── (0,1) ── (0,2)
  │        │        │
(1,0) ── (1,1) ── (1,2)
  │        │        │
(2,0) ── (2,1) ── (2,2)
```

每個連接（分支）都有一個 pixel model，包含：
- Rx = 0.1 Ω（水平方向）
- Ry = 0.1 Ω（垂直方向）
- Rz = 0.5 Ω（層間，這裡只有一層，所以不用）

## 步驟 1：建立基準網路

### 初始狀態
```
所有 pixel model：
  Rx = 0.1 Ω
  Ry = 0.1 Ω
  Rz = 0.5 Ω（未使用）
```

### 計算網路總電阻
```
水平分支：3行 × 2個/行 = 6個分支，每個 0.1 Ω
垂直分支：3列 × 2個/列 = 6個分支，每個 0.1 Ω
總分支數：12個

總電阻 = 6 × 0.1 + 6 × 0.1 = 1.2 Ω
平均分支電阻 = 1.2 / 12 = 0.1 Ω
```

**基準結果**：
- TotalR = 1.2 Ω
- AvgBranchR = 0.1 Ω

## 步驟 2：掃描 Rx（單一 R 值分析）

### 測試 1：Rx = 0.05 Ω（0.5x）
```
所有 pixel model：
  Rx = 0.05 Ω  ← 改變
  Ry = 0.1 Ω   ← 不變
  Rz = 0.5 Ω   ← 不變

水平分支：6個，每個 0.05 Ω = 0.3 Ω
垂直分支：6個，每個 0.1 Ω = 0.6 Ω
總電阻 = 0.3 + 0.6 = 0.9 Ω
```

### 測試 2：Rx = 0.1 Ω（1.0x，基準值）
```
總電阻 = 1.2 Ω（如上）
```

### 測試 3：Rx = 0.15 Ω（1.5x）
```
水平分支：6個，每個 0.15 Ω = 0.9 Ω
垂直分支：6個，每個 0.1 Ω = 0.6 Ω
總電阻 = 0.9 + 0.6 = 1.5 Ω
```

### 測試 4：Rx = 0.2 Ω（2.0x）
```
水平分支：6個，每個 0.2 Ω = 1.2 Ω
垂直分支：6個，每個 0.1 Ω = 0.6 Ω
總電阻 = 1.2 + 0.6 = 1.8 Ω
```

### 結果分析

| Rx (Ω) | TotalR (Ω) | 變化 |
|--------|------------|------|
| 0.05   | 0.9        | -0.3 |
| 0.10   | 1.2        | 0.0  |
| 0.15   | 1.5        | +0.3 |
| 0.20   | 1.8        | +0.6 |

**敏感度計算**：
```
敏感度 = ΔTotalR / ΔRx
       = (1.8 - 0.9) / (0.20 - 0.05)
       = 0.9 / 0.15
       = 6.0
```

**解讀**：
- Rx 每增加 0.01 Ω，總電阻增加 0.06 Ω
- Rx 對總電阻有**中等影響**

## 步驟 3：掃描 Ry（對比分析）

### 測試結果

| Ry (Ω) | TotalR (Ω) | 變化 |
|--------|------------|------|
| 0.05   | 0.9        | -0.3 |
| 0.10   | 1.2        | 0.0  |
| 0.15   | 1.5        | +0.3 |
| 0.20   | 1.8        | +0.6 |

**敏感度**：6.0（與 Rx 相同，因為網格是對稱的）

## 步驟 4：同時掃描所有 R 值

### 測試結果

| Ratio | Rx (Ω) | Ry (Ω) | TotalR (Ω) | 變化 |
|-------|--------|--------|------------|------|
| 0.5x  | 0.05   | 0.05   | 0.6        | -0.6 |
| 1.0x  | 0.10   | 0.10   | 1.2        | 0.0  |
| 1.5x  | 0.15   | 0.15   | 1.8        | +0.6 |
| 2.0x  | 0.20   | 0.20   | 2.4        | +1.2 |

**敏感度計算**：
```
敏感度 = ΔTotalR / ΔRx（或 ΔRy）
       = (2.4 - 0.6) / (0.20 - 0.05)
       = 1.8 / 0.15
       = 12.0
```

**解讀**：
- 當所有 R 值同時變化時，影響是**累加的**
- 敏感度是單一 R 值的 2 倍（因為 Rx 和 Ry 都變了）

## 步驟 5：解讀結果

### 關鍵發現

1. **Rx 和 Ry 的影響相同**
   - 因為網格是對稱的
   - 敏感度都是 6.0

2. **同時改變所有 R 值影響更大**
   - 敏感度是 12.0（2 倍）
   - 說明如果所有 R 值都不準確，影響會累加

3. **線性關係**
   - 總電阻與 R 值成線性關係
   - 這在簡單網路中很常見

### 實際意義

**如果 Rx 值不準確**：
- 誤差 10%（0.1 → 0.11 Ω）
- 總電阻誤差 = 0.1 × 6.0 = 0.6 Ω
- 相對誤差 = 0.6 / 1.2 = 5%

**結論**：
- Rx 的 10% 誤差會導致總電阻 5% 的誤差
- 這說明**找到準確的 R 值確實重要**

## 步驟 6：視覺化結果

### 圖表 1：Rx vs TotalR
```
TotalR (Ω)
  2.0 |                    *
      |               *
  1.5 |          *
      |     *
  1.0 |*
      |________________________
      0.05  0.10  0.15  0.20  Rx (Ω)
```

### 圖表 2：敏感度比較
```
敏感度
 12.0 |                    *
      |                    *
  6.0 |          *         *
      |     *         *
  0.0 |________________________
      Rx    Ry     All
```

## 實際應用建議

### 1. 如果敏感度高（> 10）
- **行動**：投入更多資源做精確的 R 值建模
- **理由**：R 值的小誤差會導致結果的大誤差

### 2. 如果敏感度中等（5-10）
- **行動**：使用標準的 R 值建模方法
- **理由**：有一定影響，但不需要極度精確

### 3. 如果敏感度低（< 5）
- **行動**：可以使用簡化的 R 值模型
- **理由**：R 值的誤差對結果影響不大

## 進階分析

### 非線性情況

在某些複雜網路中，敏感度可能不是常數：

```
Rx 很小時：敏感度高（網路瓶頸）
Rx 很大時：敏感度低（其他路徑更重要）
```

### 交互作用

當同時改變多個 R 值時，可能會有交互作用：
- Rx 和 Ry 同時變大 → 影響可能不是簡單相加
- 需要多變量分析來理解

## 總結

這個例子展示了：
1. **如何執行敏感度分析**：系統性地改變 R 值
2. **如何計算敏感度**：ΔTotalR / ΔR
3. **如何解讀結果**：敏感度高 = 影響大
4. **如何應用結果**：根據敏感度決定建模精度

通過這種分析，你可以：
- 量化 R 值的重要性
- 證明找到「好的 R 值」的價值
- 優化建模和設計流程

